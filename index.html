<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DGA Loon & Dividend Optimalisatie</title>
<style>
  body { font-family: Arial, sans-serif; background: #fcfcf9; max-width: 1200px; margin: auto; color: #254751; padding: 1rem;}
  h1,h2 { color: #1e5d63; }
  label { font-weight: 600; }
  .card { background: #fff; border-radius: 8px; padding: 1rem 1.5rem; margin-bottom: 1.5rem; box-shadow: 0 2px 8px rgb(0 0 0 / 0.1); }
  input[type=number] { width: 100%; padding: 0.4rem; font-size: 1rem; border-radius: 4px; border: 1px solid #ccd; box-sizing: border-box;}
  .flex-row { display: flex; gap: 1rem; flex-wrap: wrap; }
  .flex-item { flex: 1 1 220px; min-width: 180px; }
  table { width: 100%; border-collapse: collapse; margin-top: 1rem; }
  th, td { border: 1px solid #ddd; padding: 0.6rem 1rem; text-align: right; }
  th { background: #e7f2f2; }
  td.label { text-align: left; font-weight: bold; }
  .notice { background-color: #d9f1f4; color: #135; border-left: 5px solid #3c959b; padding: 0.9rem 1rem; margin-bottom: 1rem; font-style: italic; }
  canvas { max-width: 100%; margin-bottom: 2rem; }
  .footer { margin-top: 1.5rem; font-size: 0.8rem; color: #667; }
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<h1>DGA Loon & Dividend Optimalisatie Dashboard</h1>
<p>Vergelijk je huidige situatie met fiscaal optimale splitsing tussen loon en dividend over 3 jaar.</p>

<div class="card">
  <h2>Invoer</h2>
  <div class="flex-row">
    <div class="flex-item">
      <label for="brutoSalaris">Bruto maandsalaris dit jaar (€):</label>
      <input type="number" id="brutoSalaris" value="6000" min="0" step="50" />
    </div>
    <div class="flex-item">
      <label for="vakantiegeld">Vakantiegeld per jaar (€):</label>
      <input type="number" id="vakantiegeld" value="2800" min="0" step="50" />
    </div>
    <div class="flex-item">
      <label for="nettoMaandWens">Gewenst netto privé per maand (€):</label>
      <input type="number" id="nettoMaandWens" value="4000" min="0" step="10" />
    </div>
    <div class="flex-item">
      <label for="minimumLoon">Fiscaal minimum gebruikelijk loon per jaar (€):</label>
      <input type="number" id="minimumLoon" value="56000" min="35000" max="76000" step="1000" />
    </div>
  </div>
</div>

<div class="notice" id="meldingDividend"></div>

<div class="card">
  <h2>Vergelijkingstabel (3 jaar)</h2>
  <table>
    <thead>
      <tr>
        <th>Omschrijving</th>
        <th>Jaar 1: Huidige situatie</th>
        <th>Jaar 2: Geoptimaliseerd</th>
        <th>Jaar 3: Geoptimaliseerd</th>
        <th>Verschil jaar 2 t.o.v. jaar 1</th>
      </tr>
    </thead>
    <tbody id="vergelijkingBody"></tbody>
  </table>
</div>

<div class="card">
  <h2>Grafieken</h2>
  <canvas id="barChart"></canvas>
  <canvas id="nettoMaandChart"></canvas>
  <canvas id="belastingChart"></canvas>
  <canvas id="cumChart"></canvas>
</div>

<script>
const box1Tarief = 0.3697;
const box2Tarief = 0.269;

const brutoSalarisInput = document.getElementById('brutoSalaris');
const vakantiegeldInput = document.getElementById('vakantiegeld');
const nettoMaandWensInput = document.getElementById('nettoMaandWens');
const minimumLoonInput = document.getElementById('minimumLoon');
const meldingDividendEl = document.getElementById('meldingDividend');

let barChart, nettoMaandChart, belastingChart, cumChart;

function formatEuro(val){
  return val.toLocaleString('nl-NL',{style:'currency',currency:'EUR',minimumFractionDigits:2});
}

function berekenNettoVanBruto(bruto){
  return bruto*(1-box1Tarief);
}

function bereken() {
  let brutoMaandHuidig = parseFloat(brutoSalarisInput.value) || 0;
  let vakantiegeld = parseFloat(vakantiegeldInput.value) || 0;
  let nettoWensMaand = parseFloat(nettoMaandWensInput.value) || 0;
  let minimumLoonJaar = parseFloat(minimumLoonInput.value) || 56000;

  // Jaar 1
  let brutoJaarHuidig = brutoMaandHuidig*12;
  let nettoMaandHuidig = brutoMaandHuidig*(1-box1Tarief) + (vakantiegeld*0.8/12);
  let nettoJaarHuidig = nettoMaandHuidig*12;

  // Melding dividend verplicht of niet
  if(nettoWensMaand <= berekenNettoVanBruto(minimumLoonJaar) /12){
    meldingDividendEl.textContent = "Dividenduitkering is (nog) niet nodig, netto maandwens valt binnen fiscaal minimum loon.";
  } else {
    meldingDividendEl.textContent = "Let op: netto maandwens is hoger dan fiscaal minimum loon, dividenduitkering wordt dan fiscaal interessant.";
  }

  // Geoptimaliseerd (min loon + dividend)
  let nettoMaandMinLoon = berekenNettoVanBruto(minimumLoonJaar)/12;
  let nettoJaarMinLoon = nettoMaandMinLoon*12;

  let nettoDividendPerJaar = Math.max(0,(nettoWensMaand-nettoMaandMinLoon)*12);
  let brutoDividendPerJaar = nettoDividendPerJaar/(1-box2Tarief);
  let nettoDividendPerMaand = nettoDividendPerJaar/12;

  let totaalBrutoJaarOptimaal = minimumLoonJaar + brutoDividendPerJaar;

  // Jaar 2 en 3 gelijk
  let nettoJaarOptimaal = nettoJaarMinLoon + nettoDividendPerJaar;
  let brutoJaarOptimaal = totaalBrutoJaarOptimaal;

  let nettoMaandOptimaal = nettoJaarOptimaal / 12;
  let brutoMaandOptimaal = brutoJaarOptimaal / 12;

  // Belastingen berekening huidig en optimaal
  let belastingJaarHuidig = brutoJaarHuidig - nettoJaarHuidig;
  let belastingLoonOptimaal = minimumLoonJaar - nettoJaarMinLoon;
  let belastingDividendOptimaal = brutoDividendPerJaar - nettoDividendPerJaar;
  let belastingTotaalOptimaal = belastingLoonOptimaal + belastingDividendOptimaal;

  // Verschillen
  let verschilBrutoJaar = brutoJaarOptimaal - brutoJaarHuidig;
  let verschilNettoJaar = nettoJaarOptimaal - nettoJaarHuidig;

  // Tabel vullen
  const tbody = document.getElementById('vergelijkingBody');
  tbody.innerHTML = `
    <tr><td class="label">Bruto jaarsalaris</td><td>${formatEuro(brutoJaarHuidig)}</td><td>${formatEuro(minimumLoonJaar)}</td><td>${formatEuro(minimumLoonJaar)}</td><td>${formatEuro(minimumLoonJaar-brutoJaarHuidig)}</td></tr>
    <tr><td class="label">Bruto dividend (voorfinanciering netto gat)</td><td>–</td><td>${formatEuro(brutoDividendPerJaar)}</td><td>${formatEuro(brutoDividendPerJaar)}</td><td>–</td></tr>
    <tr><td class="label"><strong>Totaal uit de BV per jaar (bruto loon + dividend)</strong></td><td><strong>${formatEuro(brutoJaarHuidig)}</strong></td><td><strong>${formatEuro(brutoJaarOptimaal)}</strong></td><td><strong>${formatEuro(brutoJaarOptimaal)}</strong></td><td><strong>${formatEuro(verschilBrutoJaar)}</strong></td></tr>
    <tr><td class="label">Bruto maandsalaris</td><td>${formatEuro(brutoMaandHuidig)}</td><td>${formatEuro(brutoMaandOptimaal)}</td><td>${formatEuro(brutoMaandOptimaal)}</td><td>${formatEuro(brutoMaandOptimaal-brutoMaandHuidig)}</td></tr>
    <tr><td class="label">Netto maandsalaris</td><td>${formatEuro(nettoMaandHuidig)}</td><td>${formatEuro(nettoMaandMinLoon)}</td><td>${formatEuro(nettoMaandMinLoon)}</td><td>${formatEuro(nettoMaandMinLoon-nettoMaandHuidig)}</td></tr>
    <tr><td class="label">Netto jaarloon</td><td>${formatEuro(nettoJaarHuidig)}</td><td>${formatEuro(nettoJaarMinLoon)}</td><td>${formatEuro(nettoJaarMinLoon)}</td><td>${formatEuro(nettoJaarMinLoon-nettoJaarHuidig)}</td></tr>
    <tr><td class="label">Netto dividend</td><td>–</td><td>${formatEuro(nettoDividendPerJaar)}</td><td>${formatEuro(nettoDividendPerJaar)}</td><td>–</td></tr>
    <tr><td class="label"><strong>Totaal netto privé per jaar</strong></td><td><strong>${formatEuro(nettoJaarHuidig)}</strong></td><td><strong>${formatEuro(nettoJaarOptimaal)}</strong></td><td><strong>${formatEuro(nettoJaarOptimaal)}</strong></td><td><strong>${formatEuro(verschilNettoJaar)}</strong></td></tr>
    <tr><td class="label">Totale belastingdruk (jaarloon + dividend)</td><td>${formatEuro(belastingJaarHuidig)}</td><td>${formatEuro(belastingTotaalOptimaal)}</td><td>${formatEuro(belastingTotaalOptimaal)}</td><td>${formatEuro(belastingTotaalOptimaal - belastingJaarHuidig)}</td></tr>
  `;

  // Grafieken
  updateCharts(brutoJaarHuidig, brutoJaarOptimaal, nettoMaandHuidig, nettoMaandMinLoon, nettoDividendPerMaand);
}

function updateCharts(brutoJaar1, brutoJaar2, nettoMaand1, nettoMaandLoonOptimaal, nettoDividendPerMaand){
  if (barChart) barChart.destroy();
  if (nettoMaandChart) nettoMaandChart.destroy();
  if (belastingChart) belastingChart.destroy();
  if (cumChart) cumChart.destroy();

  barChart = new Chart(document.getElementById('barChart').getContext('2d'), {
    type: 'bar',
    data: {
      labels: ['Huidig Jaar', 'Geoptimaliseerd'],
      datasets: [
        { label: 'Bruto uit BV per jaar', data: [brutoJaar1, brutoJaar2], backgroundColor: 'rgba(33,128,141,0.6)' },
        { label: 'Netto loon per maand', data: [nettoMaand1, nettoMaandLoonOptimaal], backgroundColor: 'rgba(230,129,97,0.6)' },
        { label: 'Netto dividend per maand', data: [0, nettoDividendPerMaand], backgroundColor: 'rgba(87,163,137,0.7)' }
      ]
    },
    options: {
      responsive: true,
      scales: {
        y: {
          beginAtZero: true,
          ticks: { callback: val => '€' + val.toLocaleString() }
        }
      },
      plugins: {
        legend: { position: 'top' },
        title: { display: false }
      }
    }
  });

  const maanden = ['Jan','Feb','Mrt','Apr','Mei','Jun','Jul','Aug','Sep','Okt','Nov','Dec'];
  const huidigNettoData = Array(12).fill(nettoMaand1);
  const optimaalNettoData = Array(11).fill(nettoMaandLoonOptimaal);
  optimaalNettoData.push(nettoMaandLoonOptimaal + nettoDividendPerMaand * 12);

  nettoMaandChart = new Chart(document.getElementById('nettoMaandChart').getContext('2d'), {
    type: 'line',
    data: {
      labels: maanden,
      datasets: [
        { label: 'Netto privé uitkering huidig', data: huidigNettoData, borderColor: 'rgba(33,128,141,1)', backgroundColor: 'rgba(33,128,141,0.25)', fill: true, tension: 0.3 },
        { label: 'Netto privé uitkering geoptimaliseerd', data: optimaalNettoData, borderColor: 'rgba(230,129,97,1)', backgroundColor: 'rgba(230,129,97,0.25)', fill: true, tension: 0.3 }
      ]
    },
    options: {
      responsive: true,
      scales: {
        y: {
          beginAtZero: false,
          ticks: { callback: val => '€' + val.toLocaleString() }
        }
      },
      plugins: {
        legend: { position: 'top' }
      }
    }
  });

  belastingChart = new Chart(document.getElementById('belastingChart').getContext('2d'), {
    type: 'bar',
    data: {
      labels: ['Box 1 loonbelasting', 'Box 2 dividendbelasting'],
      datasets: [{
        label: 'Belastingtarief (%)',
        data: [box1Tarief * 100, box2Tarief * 100],
        backgroundColor: ['rgba(33,128,141,0.6)', 'rgba(230,129,97,0.6)']
      }]
    },
    options: {
      indexAxis: 'y',
      plugins: { legend: { display: false } },
      scales: { x: { max: 100, ticks: { callback: val => val + '%' } } }
    }
  });

  function cumulatief(arr) {
    let result = [];
    arr.reduce((a, b, i) => result[i] = a + b, 0);
    return result;
  }

  const cumulJaar1 = cumulatief(huidigNettoData);
  const cumulJaar2 = cumulatief(optimaalNettoData);

  cumChart = new Chart(document.getElementById('cumChart').getContext('2d'), {
    type: 'line',
    data: {
      labels: maanden,
      datasets: [
        {
          label: 'Cumulatief netto huidig',
          data: cumulJaar1,
          borderColor: 'rgba(33,128,141,0.9)',
          backgroundColor: 'rgba(33,128,141,0.1)',
          fill: true,
          tension: 0.2
        },
        {
          label: 'Cumulatief netto geoptimaliseerd',
          data: cumulJaar2,
          borderColor: 'rgba(230,129,97,0.9)',
          backgroundColor: 'rgba(230,129,97,0.15)',
          fill: true,
          tension: 0.2
        }
      ]
    },
    options: {
      responsive: true,
      plugins: { legend: { position: 'top' } }
    }
  });
}

document.querySelectorAll('input[type=number]').forEach(input => input.addEventListener('input', bereken));
window.onload = bereken;
</script>

<div class="footer">
  &copy; 2025 Accountant DGA Optimalisatie Dashboard
</div>
</body>
</html>
